# 自动化工具使用说明

> AI PPT导演系统 - Python自动化工具包

---

## 环境准备

### 1. 安装Python

确保已安装Python 3.8或更高版本：
```bash
python --version
# 或
python3 --version
```

如未安装，请访问 https://www.python.org/downloads/ 下载。

---

### 2. 安装依赖包

在项目的 `05_自动化工具/` 目录下运行：

```bash
# macOS/Linux
cd 05_自动化工具
pip3 install -r requirements.txt

# Windows
cd 05_自动化工具
pip install -r requirements.txt
```

**可能遇到的问题**：
- 如果提示权限错误，加上 `--user` 参数
- 如果提示pip版本过旧，运行 `pip install --upgrade pip`

---

## 工具1：图表生成器（generate_chart.py）

### 功能
快速生成符合视觉规范的高端图表（柱状图、折线图、饼图）。

---

### 基础用法

#### 生成柱状图
```bash
python generate_chart.py --type bar --data "Q1:85,Q2:92,Q3:88,Q4:95" --color blue
```

**输出**：`chart_bar_blue.png`

---

#### 生成折线图
```bash
python generate_chart.py --type line --data "1月:100,2月:120,3月:115,4月:150" --color orange --title "月度GMV增长"
```

**输出**：`chart_line_orange.png`

---

#### 生成饼图
```bash
python generate_chart.py --type pie --data "产品A:30,产品B:25,产品C:20,产品D:25" --color green
```

**输出**：`chart_pie_green.png`

---

### 参数说明

| 参数 | 简写 | 必填 | 说明 | 可选值 |
|------|------|------|------|--------|
| `--type` | `-t` | ✓ | 图表类型 | `bar`(柱状图), `line`(折线图), `pie`(饼图) |
| `--data` | `-d` | ✓ | 数据 | 见"数据格式"章节 |
| `--color` | `-c` | ✗ | 配色方案 | `blue`(科技蓝), `orange`(商务橙), `green`(专业绿) |
| `--title` | `-T` | ✗ | 图表标题 | 任意文字 |
| `--output` | `-o` | ✗ | 输出文件名 | 如：`my_chart.png` |

---

### 数据格式

#### 格式1：带类别（推荐）
```
"类别1:数值1,类别2:数值2,类别3:数值3"
```

**示例**：
```bash
--data "Q1:85,Q2:92,Q3:88,Q4:95"
--data "产品A:1000,产品B:800,产品C:1200"
--data "北京:50,上海:60,广州:45,深圳:55"
```

#### 格式2：仅数值
```
"数值1,数值2,数值3"
```
自动生成类别名称（项目1、项目2...）

**示例**：
```bash
--data "85,92,88,95"
```

---

### 配色方案

| 方案代码 | 方案名称 | 适用场景 | 主色 |
|---------|---------|---------|------|
| `blue` | 科技蓝 | 技术类、创新类汇报 | #4A90E2 |
| `orange` | 商务橙 | 商务、销售、市场类汇报 | #FF9500 |
| `green` | 专业绿 | 运营、可持续发展类汇报 | #00D084 |

---

### 高级用法

#### 自定义输出路径
```bash
python generate_chart.py --type bar --data "Q1:85,Q2:92" --output "../输出/季度对比.png"
```

#### 中文标题
```bash
python generate_chart.py --type line --data "1月:100,2月:120" --title "2024年GMV增长趋势" --color blue
```

#### 批量生成
创建一个脚本 `batch_generate.sh`：
```bash
#!/bin/bash
python generate_chart.py --type bar --data "Q1:85,Q2:92,Q3:88,Q4:95" --color blue --output "chart1.png"
python generate_chart.py --type line --data "Q1:100,Q2:120,Q3:115,Q4:150" --color blue --output "chart2.png"
python generate_chart.py --type pie --data "A:30,B:25,C:20,D:25" --color blue --output "chart3.png"
```

运行：
```bash
chmod +x batch_generate.sh
./batch_generate.sh
```

---

### 常见问题

#### Q1：中文显示为方框？
**A**：字体未安装。解决方法：
- macOS：系统自带苹方字体，无需安装
- Windows：确保已安装"微软雅黑"字体
- Linux：安装中文字体包
  ```bash
  sudo apt-get install fonts-wqy-zenhei
  ```

#### Q2：提示"No module named 'matplotlib'"？
**A**：依赖包未安装，运行：
```bash
pip install -r requirements.txt
```

#### Q3：生成的图表太小/太大？
**A**：编辑 `generate_chart.py`，修改第XX行的 `figsize=(10, 6)` 中的数字。

#### Q4：想要更多图表类型（如雷达图、热力图）？
**A**：使用AI生成代码（参考 `04_AI提示词库/图表生成提示词.txt`），或联系维护者添加新功能。

---

## 工具2：PPT组装器（开发中）

**功能**：根据配置文件自动组装PPT

**状态**：规划中，预计v1.1版本发布

**计划功能**：
- 读取大纲文件（Markdown格式）
- 自动创建页面
- 插入图表和文字
- 应用统一配色和字体

**替代方案**：
目前建议使用PowerPoint模板 + 手动插入图表的方式。

---

## 工具3：配色方案读取器

### 功能
读取 `03_视觉规范/配色方案.json` 中的配色定义。

### 使用方法（在Python代码中）

```python
import json

# 读取配色方案
with open('../03_视觉规范/配色方案.json', 'r', encoding='utf-8') as f:
    schemes = json.load(f)

# 获取科技蓝方案
blue_scheme = schemes['color_schemes']['scheme_a_tech_blue']
primary_color = blue_scheme['primary_colors']['gradient_start']['hex']

print(f"主色: {primary_color}")  # 输出: 主色: #4A90E2
```

---

## 开发指南

### 扩展图表类型

如需添加新的图表类型（如雷达图、瀑布图），按以下步骤操作：

1. 在 `generate_chart.py` 中添加新函数：
```python
def generate_radar_chart(categories, values, scheme, title, output):
    """生成雷达图"""
    # 你的代码
    pass
```

2. 在 `main()` 函数中添加分支：
```python
elif args.type == 'radar':
    generate_radar_chart(categories, values, scheme, title, output)
```

3. 更新 `--type` 参数的可选值：
```python
parser.add_argument('--type', '-t',
                    choices=['bar', 'line', 'pie', 'radar'],  # 添加 'radar'
                    ...)
```

### 自定义配色

编辑 `generate_chart.py` 中的 `COLOR_SCHEMES` 字典，添加新方案：
```python
COLOR_SCHEMES = {
    # ...现有方案...
    "custom": {
        "name": "自定义方案",
        "gradient": ["#YOUR_COLOR_1", "#YOUR_COLOR_2", ...],
        "primary": "#YOUR_PRIMARY",
        "accent": "#YOUR_ACCENT",
        "text": "#333333",
        "text_light": "#999999",
        "background": "#F5F5F5"
    }
}
```

---

## 性能优化建议

### 批量生成时
- 使用脚本自动化（见"高级用法"）
- 避免频繁读写文件
- 考虑使用多进程加速（适用于大量图表）

### 大数据量图表
- 如数据点>100个，考虑采样或聚合
- 使用Plotly代替Matplotlib（支持交互式）

---

## 更新日志

### v1.0 (2025-12-17)
- ✓ 基础图表生成（柱状图、折线图、饼图）
- ✓ 三套配色方案支持
- ✓ 命令行工具
- ✓ 中文字体支持

### 计划中 (v1.1)
- [ ] 雷达图、瀑布图、热力图
- [ ] PPT自动组装功能
- [ ] 批量处理配置文件
- [ ] GUI图形界面

---

## 技术支持

遇到问题？
1. 查看本文档的"常见问题"章节
2. 查看 `01_使用手册/常见问题FAQ.md`
3. 联系项目维护者

---

## 许可说明

本工具包为AI PPT导演系统的一部分，可自由用于团队内部。
使用商业字体和图标时，请确认授权范围。

---

**版本**：v1.0
**最后更新**：2025-12-17
**维护者**：技术开发组
