# 自动化工具使用说明

> AI PPT导演系统 - Python自动化工具包

---

## 环境准备

### 1. 安装Python

确保已安装Python 3.8或更高版本：
```bash
python --version
# 或
python3 --version
```

如未安装，请访问 https://www.python.org/downloads/ 下载。

---

### 2. 安装依赖包

在项目的 `05_自动化工具/` 目录下运行：

```bash
# macOS/Linux
cd 05_自动化工具
pip3 install -r requirements.txt

# Windows
cd 05_自动化工具
pip install -r requirements.txt
```

**可能遇到的问题**：
- 如果提示权限错误，加上 `--user` 参数
- 如果提示pip版本过旧，运行 `pip install --upgrade pip`

---

## 工具1：图表生成器（generate_chart.py）

### 功能
快速生成符合视觉规范的高端图表（支持6种图表类型）。

---

### 基础用法

#### 生成柱状图
```bash
python generate_chart.py --type bar --data "Q1:85,Q2:92,Q3:88,Q4:95" --color blue
```

**输出**：`chart_bar_blue.png`

---

#### 生成折线图
```bash
python generate_chart.py --type line --data "1月:100,2月:120,3月:115,4月:150" --color orange --title "月度GMV增长"
```

**输出**：`chart_line_orange.png`

---

#### 生成饼图
```bash
python generate_chart.py --type pie --data "产品A:30,产品B:25,产品C:20,产品D:25" --color green
```

**输出**：`chart_pie_green.png`

---

#### 生成环形图（v2.0新增）
```bash
python generate_chart.py --type donut --data "产品A:30,产品B:25,产品C:20,产品D:25" --color gold_blue --title "销售占比"
```

**输出**：带中心总计数值的现代环形图

---

#### 生成雷达图（v2.0新增）
```bash
python generate_chart.py --type radar --data "战略:85,执行:92,创新:78,协作:88,领导力:90" --color multilayer --title "能力评估"
```

**输出**：多维度能力评估雷达图

---

#### 生成瀑布图（v2.0新增）
```bash
python generate_chart.py --type waterfall --data "Q1基准:100,产品增长:+35,市场拓展:+28,成本优化:-8,Q4总计:155" --title "增长归因分析"
```

**输出**：增长归因分析瀑布图

---

### 参数说明

| 参数 | 简写 | 必填 | 说明 | 可选值 |
|------|------|------|------|--------|
| `--type` | `-t` | ✓ | 图表类型 | `bar`(柱状图), `line`(折线图), `pie`(饼图), `donut`(环形图)⭐, `radar`(雷达图)⭐, `waterfall`(瀑布图)⭐ |
| `--data` | `-d` | ✓ | 数据 | 见"数据格式"章节 |
| `--color` | `-c` | ✗ | 配色方案 | `blue`, `orange`, `green`, `gold_blue`⭐, `multilayer`⭐ |
| `--title` | `-T` | ✗ | 图表标题 | 任意文字 |
| `--output` | `-o` | ✗ | 输出文件名 | 如：`my_chart.png` |

⭐ = v2.0新增

---

### 数据格式

#### 格式1：带类别（推荐）
```
"类别1:数值1,类别2:数值2,类别3:数值3"
```

**示例**：
```bash
--data "Q1:85,Q2:92,Q3:88,Q4:95"
--data "产品A:1000,产品B:800,产品C:1200"
--data "北京:50,上海:60,广州:45,深圳:55"
```

#### 格式2：仅数值
```
"数值1,数值2,数值3"
```
自动生成类别名称（项目1、项目2...）

**示例**：
```bash
--data "85,92,88,95"
```

---

### 配色方案

| 方案代码 | 方案名称 | 适用场景 | 主色 |
|---------|---------|---------|------|
| `blue` | 科技蓝 | 技术类、创新类汇报 | #4A90E2 |
| `orange` | 商务橙 | 商务、销售、市场类汇报 | #FF9500 |
| `green` | 专业绿 | 运营、可持续发展类汇报 | #00D084 |
| `gold_blue` ⭐ | 高端金蓝 | 个人述职、晋升答辩、高端商务汇报 | #2C5282 + #D4AF37 |
| `multilayer` ⭐ | 多层次专业 | 年终向上汇报、综合性工作总结 | #2C5282 + #FF9500 + #D4AF37 |

⭐ = v2.0新增，基于18张真实高端PPT案例提取

---

### 高级用法

#### 自定义输出路径
```bash
python generate_chart.py --type bar --data "Q1:85,Q2:92" --output "../输出/季度对比.png"
```

#### 中文标题
```bash
python generate_chart.py --type line --data "1月:100,2月:120" --title "2024年GMV增长趋势" --color blue
```

#### 批量生成
创建一个脚本 `batch_generate.sh`：
```bash
#!/bin/bash
python generate_chart.py --type bar --data "Q1:85,Q2:92,Q3:88,Q4:95" --color blue --output "chart1.png"
python generate_chart.py --type line --data "Q1:100,Q2:120,Q3:115,Q4:150" --color blue --output "chart2.png"
python generate_chart.py --type pie --data "A:30,B:25,C:20,D:25" --color blue --output "chart3.png"
```

运行：
```bash
chmod +x batch_generate.sh
./batch_generate.sh
```

---

### 常见问题

#### Q1：中文显示为方框？
**A**：字体未安装。解决方法：
- macOS：系统自带苹方字体，无需安装
- Windows：确保已安装"微软雅黑"字体
- Linux：安装中文字体包
  ```bash
  sudo apt-get install fonts-wqy-zenhei
  ```

#### Q2：提示"No module named 'matplotlib'"？
**A**：依赖包未安装，运行：
```bash
pip install -r requirements.txt
```

#### Q3：生成的图表太小/太大？
**A**：编辑 `generate_chart.py`，修改第XX行的 `figsize=(10, 6)` 中的数字。

#### Q4：想要更多图表类型（如雷达图、热力图）？
**A**：v2.0已新增雷达图、瀑布图、环形图！查看上方使用示例。其他图表类型可参考 `04_AI提示词库/图表生成提示词_高端图表库.txt`。

---

## 工具2：时间轴生成器（generate_timeline.py）⭐ v2.0新增

### 功能
生成水平时间轴，带彩色节点和底部数据卡片，适用于项目进度、发展历程展示。

---

### 基础用法

```bash
python generate_timeline.py --data "Q1:启动阶段:完成市场调研,Q2:快速增长:用户破10万,Q3:稳步推进:优化产品体验,Q4:总结展望:全年目标达成" --color gold_blue
```

**输出**：水平时间轴图，包含4个时间节点和底部数据卡片

---

### 参数说明

| 参数 | 简写 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| `--data` | `-d` | ✓ | 时间轴数据，格式: "时间1:标题1:描述1,时间2:标题2:描述2,..." | - |
| `--color` | `-c` | ✗ | 配色方案 | `gold_blue` |
| `--title` | `-T` | ✗ | 时间轴标题 | "项目时间轴" |
| `--output` | `-o` | ✗ | 输出文件名 | `timeline_{color}.png` |

---

### 使用示例

#### 项目进度时间轴
```bash
python generate_timeline.py \
  --data "1月:需求分析:收集用户反馈,3月:设计开发:完成核心功能,6月:测试上线:Beta版发布,9月:正式运营:用户破万" \
  --color blue \
  --title "产品开发时间轴"
```

#### 年度发展历程
```bash
python generate_timeline.py \
  --data "Q1:市场拓展:新增5个城市,Q2:产品迭代:发布2.0版本,Q3:团队扩张:人员增长50%,Q4:业绩突破:GMV破亿" \
  --color multilayer \
  --title "2024年发展历程"
```

---

## 工具3：大数字卡片生成器（generate_big_numbers.py）⭐ v2.0新增

### 功能
生成核心指标展示卡片，每个卡片包含大数字、标题和描述，适用于成果汇报的首页或总结页。

---

### 基础用法

```bash
python generate_big_numbers.py --data "3000万:年度GMV:同比增长150%,10万+:活跃用户:月增长率35%,95%:客户满意度:行业领先水平" --color gold_blue
```

**输出**：3个核心指标卡片，自动布局

---

### 参数说明

| 参数 | 简写 | 必填 | 说明 | 默认值 |
|------|------|------|------|--------|
| `--data` | `-d` | ✓ | 指标数据，格式: "数值1:标题1:描述1,数值2:标题2:描述2,..." | - |
| `--color` | `-c` | ✗ | 配色方案 | `gold_blue` |
| `--title` | `-T` | ✗ | 页面标题 | "核心指标" |
| `--output` | `-o` | ✗ | 输出文件名 | `big_numbers_{color}.png` |

---

### 使用示例

#### 年度成果概览
```bash
python generate_big_numbers.py \
  --data "156%:年度增长率:超额完成目标,42个:合作伙伴:覆盖全国" \
  --color blue \
  --title "年度成果概览"
```

#### 多指标展示（自动布局）
```bash
python generate_big_numbers.py \
  --data "3000万:GMV:同比↑150%,10万+:用户:月增35%,95%:满意度:行业领先,50人:团队规模:同比↑67%,15个:核心项目:全部按期交付" \
  --color multilayer \
  --title "核心数据看板"
```

**说明**：
- 1-2个指标：横向单行布局
- 3-4个指标：2x2网格布局
- 5+个指标：3列网格布局

---

## 工具4：PPT组装器（开发中）

**功能**：根据配置文件自动组装PPT

**状态**：规划中，预计v1.1版本发布

**计划功能**：
- 读取大纲文件（Markdown格式）
- 自动创建页面
- 插入图表和文字
- 应用统一配色和字体

**替代方案**：
目前建议使用PowerPoint模板 + 手动插入图表的方式。

---

## 工具5：配色方案读取器

### 功能
读取 `03_视觉规范/配色方案.json` 中的配色定义（现已支持5套配色方案）。

### 使用方法（在Python代码中）

```python
import json

# 读取配色方案
with open('../03_视觉规范/配色方案.json', 'r', encoding='utf-8') as f:
    schemes = json.load(f)

# 获取科技蓝方案
blue_scheme = schemes['color_schemes']['scheme_a_tech_blue']
primary_color = blue_scheme['primary_colors']['gradient_start']['hex']

print(f"主色: {primary_color}")  # 输出: 主色: #4A90E2
```

---

## 开发指南

### 扩展图表类型

如需添加新的图表类型（如雷达图、瀑布图），按以下步骤操作：

1. 在 `generate_chart.py` 中添加新函数：
```python
def generate_radar_chart(categories, values, scheme, title, output):
    """生成雷达图"""
    # 你的代码
    pass
```

2. 在 `main()` 函数中添加分支：
```python
elif args.type == 'radar':
    generate_radar_chart(categories, values, scheme, title, output)
```

3. 更新 `--type` 参数的可选值：
```python
parser.add_argument('--type', '-t',
                    choices=['bar', 'line', 'pie', 'radar'],  # 添加 'radar'
                    ...)
```

### 自定义配色

编辑 `generate_chart.py` 中的 `COLOR_SCHEMES` 字典，添加新方案：
```python
COLOR_SCHEMES = {
    # ...现有方案...
    "custom": {
        "name": "自定义方案",
        "gradient": ["#YOUR_COLOR_1", "#YOUR_COLOR_2", ...],
        "primary": "#YOUR_PRIMARY",
        "accent": "#YOUR_ACCENT",
        "text": "#333333",
        "text_light": "#999999",
        "background": "#F5F5F5"
    }
}
```

---

## 性能优化建议

### 批量生成时
- 使用脚本自动化（见"高级用法"）
- 避免频繁读写文件
- 考虑使用多进程加速（适用于大量图表）

### 大数据量图表
- 如数据点>100个，考虑采样或聚合
- 使用Plotly代替Matplotlib（支持交互式）

---

## 更新日志

### v2.0 (2025-12-18) ⭐当前版本

**重大更新**：基于18张真实高端PPT案例的深度分析

- ✅ **新增3种图表类型**：环形图、雷达图、瀑布图
- ✅ **新增2套配色方案**：高端金蓝(gold_blue)、多层次专业(multilayer)
- ✅ **新增时间轴生成器**：generate_timeline.py
- ✅ **新增大数字卡片生成器**：generate_big_numbers.py
- ✅ **所有工具支持5套配色方案**
- ✅ **完整的使用文档和示例**

### v1.0 (2025-12-17)
- ✓ 基础图表生成（柱状图、折线图、饼图）
- ✓ 三套配色方案支持（蓝、橙、绿）
- ✓ 命令行工具
- ✓ 中文字体支持

### 计划中 (v2.1)
- [ ] 热力图、桑基图等高级图表
- [ ] PPT自动组装功能
- [ ] 批量处理配置文件
- [ ] GUI图形界面

---

## 快速工作流示例

### 完整年终汇报图表生成流程

```bash
# 1. 核心指标（首页）
python generate_big_numbers.py \
  --data "3000万:年度GMV:同比增长150%,10万+:活跃用户:月增长率35%,95%:客户满意度:行业领先水平" \
  --color gold_blue \
  --title "2024年度核心成果" \
  --output "01_核心指标.png"

# 2. 时间轴（发展历程）
python generate_timeline.py \
  --data "Q1:启动阶段:完成市场调研,Q2:快速增长:用户破10万,Q3:稳步推进:优化产品体验,Q4:总结展望:全年目标达成" \
  --color gold_blue \
  --title "2024年发展历程" \
  --output "02_发展历程.png"

# 3. 季度对比（柱状图）
python generate_chart.py \
  --type bar \
  --data "Q1:2500,Q2:3200,Q3:3800,Q4:4500" \
  --color gold_blue \
  --title "季度GMV增长趋势" \
  --output "03_季度GMV.png"

# 4. 能力评估（雷达图）
python generate_chart.py \
  --type radar \
  --data "战略规划:90,执行力:92,创新能力:85,团队协作:88,领导力:86" \
  --color multilayer \
  --title "核心能力评估" \
  --output "04_能力评估.png"

# 5. 增长归因（瀑布图）
python generate_chart.py \
  --type waterfall \
  --data "年初基准:2500,产品优化:+800,市场拓展:+600,运营提效:+400,成本优化:+200,年末总计:4500" \
  --color gold_blue \
  --title "GMV增长归因分析" \
  --output "05_增长归因.png"
```

**说明**：以上5张图表覆盖年终汇报的核心页面，全部使用统一的 `gold_blue` 配色方案，确保视觉一致性。

---

## 技术支持

遇到问题？
1. 查看本文档的"常见问题"章节
2. 查看 `01_使用手册/常见问题FAQ.md`
3. 查看 `04_AI提示词库/图表生成提示词_高端图表库.txt` 获取更多代码示例
4. 联系项目维护者

---

## 许可说明

本工具包为AI PPT导演系统的一部分，可自由用于团队内部。
使用商业字体和图标时，请确认授权范围。

---

**版本**：v2.0
**最后更新**：2025-12-18
**维护者**：技术开发组
